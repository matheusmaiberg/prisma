# Universal Agent Framework - Configuração Central
# Implementação sobre sistema PRISMA existente

versao: 1.0.0
tipo: configuracao_universal_framework
sistema_base: prisma

# Parâmetros Centrais
parametros:
  limite_tokens_alan: 500
  threshold_confidence: 0.7
  timeout_delegacao: 30000
  max_tentativas_fallback: 3

# Pesos do Sistema de Scoring
scoring_weights:
  capability_match: 0.4      # Especialização vs requisitos da tarefa
  availability: 0.25         # Disponibilidade atual do agente
  recent_performance: 0.25   # Performance recente em tarefas similares
  context_relevance: 0.1     # Relevância do contexto atual

# Configuração de Agentes Especializados
agentes:
  sarah-product-owner:
    especialidades:
      - requisitos
      - valor_negocio
      - priorização
      - critérios_aceitação
      - backlog
      - stakeholders
      - roadmap
      - features
    max_load: 8
    timeout: 30000
    performance_inicial: 0.8
    dominio: "negocio"

  james-developer:
    especialidades:
      - implementação
      - código
      - debug
      - testes_unitários
      - refactoring
      - deployment
      - apis
      - frontend
      - backend
    max_load: 5
    timeout: 60000
    performance_inicial: 0.85
    dominio: "desenvolvimento"

  bob-scrum-master:
    especialidades:
      - histórias
      - planning
      - coordenação
      - workflows
      - sprints
      - retrospectivas
      - estimativas
      - bloqueios
    max_load: 10
    timeout: 20000
    performance_inicial: 0.75
    dominio: "gestao"

  quinn-qa:
    especialidades:
      - qualidade
      - testes
      - riscos
      - gates
      - nfr
      - automação
      - cobertura
      - validação
    max_load: 6
    timeout: 45000
    performance_inicial: 0.9
    dominio: "qualidade"

  winston-arquiteto:
    especialidades:
      - arquitetura
      - design
      - adr
      - decisões_técnicas
      - padrões
      - escalabilidade
      - performance
      - integrações
    max_load: 4
    timeout: 90000
    performance_inicial: 0.8
    dominio: "arquitetura"

# Mapeamento de Triggers para Delegação Automática
triggers_delegacao:
  keywords_sarah:
    - "requisito"
    - "negócio"
    - "valor"
    - "prioridade"
    - "stakeholder"
    - "backlog"
    - "feature"
    - "critério"

  keywords_james:
    - "implementar"
    - "código"
    - "desenvolver"
    - "debug"
    - "refatorar"
    - "deploy"
    - "api"
    - "função"

  keywords_bob:
    - "história"
    - "épico"
    - "planning"
    - "sprint"
    - "coordenar"
    - "workflow"
    - "estimativa"
    - "bloqueio"

  keywords_quinn:
    - "teste"
    - "qualidade"
    - "risco"
    - "gate"
    - "validar"
    - "nfr"
    - "cobertura"
    - "automação"

  keywords_winston:
    - "arquitetura"
    - "design"
    - "adr"
    - "padrão"
    - "escalabilidade"
    - "performance"
    - "integração"
    - "decisão técnica"

# Estratégias de Context Bridge
context_bridge:
  compressao:
    enabled: true
    max_tokens_contexto: 200
    algoritmo: "prioridade_relevancia"
    preserve_keywords: true

  transferencia:
    formato: "structured_handoff"
    include_history: false
    include_metrics: true
    timeout_transfer: 5000

  persistencia:
    diretorio: "_compartilhado/tarefas"
    formato_arquivo: "json"
    retention_dias: 7
    backup_enabled: true

# Configurações de Performance
performance:
  metricas_coletadas:
    - tempo_execucao
    - qualidade_resultado
    - satisfacao_usuario
    - taxa_sucesso
    - num_fallbacks

  thresholds_alerta:
    tempo_execucao_max: 120000  # 2 minutos
    taxa_sucesso_min: 0.8       # 80%
    qualidade_min: 0.7          # 70%

  otimizacoes:
    cache_scoring: true
    cache_ttl: 300000  # 5 minutos
    parallel_scoring: false
    lazy_loading: true

# Estratégias de Recovery
recovery:
  fallback_sequence:
    1: "tentar_segundo_melhor_agente"
    2: "executar_diretamente_alan"
    3: "solicitar_intervencao_usuario"

  timeout_handling:
    warning_threshold: 0.8  # 80% do timeout
    escalation_enabled: true
    auto_retry: true
    max_retries: 2

  error_patterns:
    agent_unavailable: "tentar_proximo_agente"
    context_too_large: "comprimir_contexto"
    skill_mismatch: "recalcular_scoring"
    timeout_exceeded: "ativar_fallback"

# Logging e Auditoria
logging:
  nivel: "INFO"
  incluir_scoring_details: true
  incluir_context_transfers: true
  incluir_performance_metrics: true

  arquivos:
    decisions: "_compartilhado/logs/decisions.json"
    performance: "_compartilhado/logs/performance.json"
    errors: "_compartilhado/logs/errors.json"

# Comandos Específicos do Framework
comandos_framework:
  debug:
    - "*universal status"
    - "*universal scores [tarefa]"
    - "*universal performance"
    - "*universal config"

  admin:
    - "*universal reset-scores"
    - "*universal tune-weights"
    - "*universal clear-cache"
    - "*universal export-metrics"

# Integração com Sistema PRISMA
integracao_prisma:
  preserve_comandos_originais: true
  extend_existing_workflows: true
  backward_compatibility: true

  pontos_integracao:
    alan_diretor: "sistema_scoring_integrado"
    agentes_especializados: "context_bridge_extension"
    _compartilhado: "configuracao_centralizada"

  validacao_compatibilidade:
    testes_regressao: true
    validacao_performance: true
    verificacao_memoria: true

# Status de Implementação
status:
  implementado: true
  testado: false
  em_producao: false
  versao_prisma_base: "3.0.0"
  data_implementacao: "2025-01-23"

# Próximos Passos
roadmap:
  fase_1: "Implementação base completa"
  fase_2: "Testes de integração"
  fase_3: "Otimização de performance"
  fase_4: "Machine learning de padrões"